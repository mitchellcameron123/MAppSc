<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>trees</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">




<!-- To-do:  -->
<!-- - ensure that other chapters are consistent with this notation.  -->
<!-- - add a comparison to metalearners  -->
<section id="sec-trees" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Causal Trees and Forests</h1>
<p>Traditional causal inference methods such as regression analysis provide excellent capabilities but also face several limitations. First, many conventional methods assume that treatment effects are homogeneous across the population, which is often unrealistic. In practice, the effect of a treatment can vary significantly across different subgroups or individuals, a concept known as ‘treatment effect heterogeneity’. Second, traditional methods struggle with high-dimensional data where the number of covariates is large relative to the sample size. Lastly, the real-world relationships between variables are often non-linear and involve complex interactions that traditional linear models cannot capture adequately. Given these limitations, there is a clear need for non-parametric methods that could flexibly model complex relationships and treatment heterogeneity without imposing strong parametric assumptions. This need motivates the development of machine learning approaches tailored for causal inference such as causal trees and causal forests.</p>
<p>By providing a machine learning approach to handling heterogeneity in treatment effects, causal trees and forests enable researchers and practitioners to draw more targeted and nuanced conclusions from their data, ultimately leading to better-informed decision-making. Specifically of interest is personalised and targeted medicine or policy learning. By modelling treatment effect heterogeneity, there is knowledge of how a particular treatment will impact an individual or a subgroup inside a population. For example, if a medical researcher understands the effect of a medication for a specific subgroup then medical prescription can be personalized. In a policy context, decision-makers could target an intervention or programme towards those who benefit most or those where the benifit exceeds the cost of participation.</p>
<p>Recent research in causal inference has focused on developing methods to estimate treatment effect heterogeneity. This section provides a comprehensive overview of causal trees and forests, including generalized random forest methods. Additionally, these methods are exemplified using the <code>htetree</code> and <code>grf</code> packages available for the R statistical language.</p>
<!-- perhaps add some prescision to the intro of what high dim means -->
<section id="sec-causal-tree-intro" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sec-causal-tree-intro"><span class="header-section-number">1.1</span> Causal Trees: Overview and Intuition</h2>
<p>To adapt a Classification and Regression Tree (CART) to a causal context, <span class="citation" data-cites="Athey2016">Athey and Imbens (<a href="#ref-Athey2016" role="doc-biblioref">2016</a>)</span> develop the causal tree (CT). If unfirmilar with CART, please consider reading <strong>?@sec-background-cart</strong> before proceeding. First, the authors derive a mean square error function allowing trees to identify heterogeneous treatment effects (HTEs). Second, they develop the honesty theorem to ensure desirable asymptotic properties for tree-based estimation of HTEs.</p>
<p>CTs function similarly to CART at a high level by partitioning the data, resulting in purity within child nodes. In a causal context, a better word for purity is <em>homogeneity</em>. Instead of splitting for purity (classification tree) or residual sum of squares (regression tree), the CT partitions a given parent node to create nodes where the conditional average treatment effect (CATE) is the most heterogeneous across the resulting child nodes. <span class="citation" data-cites="Athey2016">Athey and Imbens (<a href="#ref-Athey2016" role="doc-biblioref">2016</a>)</span> develop an an expected mean square error formula, <span class="math inline">\(\operatorname{EMSE}\)</span> to select splits in the CT. This function introduces a trade-off between maximising the heterogeneity across nodes and minimising the variance of the estimate of the treatment effect within nodes.</p>
<p>There is an intuitive parallel between matching methods and tree methods. Matching methods often match observations based on similarity, usually reduced to a single propensity score as in <strong>?@sec-propensity-scores</strong>. Instead, a causal tree will partition the covariate space and pseudo-match similar observations into child nodes, thus creating neighbourhoods where a comparison between treatment and control cases is robust. Using a tree-based algorithm to define a neighbourhood is advantageous because the distance metric is adaptive. By splitting on covariates that maximise HTEs, CTs identify variables and splits that best explain the heterogeneity. Thus the definition of each neighborhood is adapted to the splits which maximise the heterogeneity. The parallel is important to understand as it motivates the calculation of HTEs and the general philosophy of the tree-based estimation of HTEs.</p>
<!-- the intro here needs to define the \ell and x -->
<section id="honesty-criterion-and-estimation-of-heterogeneous-treatment-effects" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="honesty-criterion-and-estimation-of-heterogeneous-treatment-effects"><span class="header-section-number">1.1.1</span> Honesty Criterion and Estimation of Heterogeneous Treatment Effects</h3>
<p>Assuming a tree is already built, the CATE for a given terminal node is denoted <span class="math inline">\(\tau(x; \ell_i)\)</span> and can be estimated simply due to this pseudo-matching property. Recall the calculation of the average treatment effect, denoted <span class="math inline">\(\tau_{ATE}\)</span>, from <strong>?@eq-ate-estimate</strong> is the contrast of treatment and control observations in a sample. A CT estimates <span class="math inline">\(\tau(x; \ell_i)\)</span> separately inside each heterogeneous neighbourhood defined by the tree structure as if it was an independent sample. Hence, across the tree each terminal node, <span class="math inline">\(\tau(x; \ell_i)\)</span> is indexed as <span class="math inline">\(\ell_1,\dots,\ell_n\)</span>. Across the tree, <span class="math inline">\(\tau(x; \ell_i)\)</span> is estimated inside each separate terminal node using:</p>
<p><span id="eq-causal-tree-nodecalc"><span class="math display">\[
\hat{\tau}(x; \ell_i) = \hat{\mu}(x,1;\ell_i) - \hat{\mu}(x,0;\ell_i),
\tag{1}\]</span></span></p>
<p>where <span class="math inline">\(\hat{\mu}\)</span> the estimate of the mean of each treatment group <span class="math inline">\(t \in \{0,1\}\)</span>, with attributes <span class="math inline">\(x\)</span>, contained within a given terminal node <span class="math inline">\(\ell_i\)</span>. In other words, for a given terminal node, <span class="math inline">\(\hat{\tau}(x;\ell_i)\)</span> is the contrast of the mean value between treatment and control observations. The conditional part of the CATE is implied by the structure of the tree preceding the terminal node where a particular <span class="math inline">\(\hat{\tau}(x;\ell_i))\)</span> is evaluated. Each preceding split is interpreted as a <em>decision rule</em>, defining the conditions upon which <span class="math inline">\(\hat{\tau}(x;\ell_i))\)</span> is conditioned.</p>
<p>To achieve asymptotically consistent estimates of the treatment effect, <span class="citation" data-cites="Athey2016">Athey and Imbens (<a href="#ref-Athey2016" role="doc-biblioref">2016</a>)</span> propose an “honest” approach, whereby one sample, <span class="math inline">\(\mathcal{S}^{tr}\)</span> is used to construct the partition and another, <span class="math inline">\(\mathcal{S}^{est}\)</span> to estimate treatment effects. In other words, the tree’s structure is created using different data than is used to estimate the treatment effect. If the same data is used for training and estimation, extreme values would likely be grouped together during splitting. During estimation, these extreme values would lead to extreme results in some terminal nodes, leading to spurious results created by the chance outliers in a particular sample. Using honesty, the same extreme values will not appear in those terminal nodes, leading to more consistent results. Intuitively, the causal tree must grow the tree structure and estimate the treatment effect. Honest splitting means that half the sample is used for each task. By anticipating honest splitting leading to lower bias, the splitting rule in <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a> focuses on variance only. Honesty is important to guarantee desirable asymptotic properties and prevent overfitting despite the reduction in sample size for splitting and estimation.</p>
<p>For example, <a href="#fig-ctree" class="quarto-xref">Figure&nbsp;1</a> is a causal tree trained using <span class="math inline">\(\mathcal{S}^{tr}\)</span> and <span class="math inline">\(\hat{\tau}(x;\ell_i)\)</span> is calculated within the shaded terminal nodes <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span> using <span class="math inline">\(\mathcal{S}^{est}\)</span>. For node <span class="math inline">\(A\)</span>, <span class="math inline">\(\hat{\tau}(x)\)</span> is evaluated by solving <a href="#eq-causal-tree-nodecalc" class="quarto-xref">Equation&nbsp;1</a> with the estimation sample, <span class="math inline">\(\mathcal{S}^{est}\)</span> falling inside <span class="math inline">\(A\)</span>, resulting in an estimate conditioned on <span class="math inline">\(X_1&gt;5\)</span>. Similarly, for <span class="math inline">\(\mathcal{S}^{est}\)</span> in <span class="math inline">\(B\)</span>, the <span class="math inline">\(\hat{\tau}(x)\)</span> is the difference in mean outcome between treatment and control, conditioned on <span class="math inline">\(X_1&lt;5\)</span> and <span class="math inline">\(X_2&gt;3.5\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ctree" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ctree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="trees_files/figure-html/fig-ctree-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ctree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Causal Tree Visualisation.
</figcaption>
</figure>
</div>
</div>
</div>
<p>This approach allows us to observe HTEs between different subgroups which is the motivation for using CTs. It is important to note that subgroups are identified through a data-driven approach rather than prior knowledge. The tree-building process involves splitting the data to discover these groups and estimate their respective <span class="math inline">\(\hat{\tau}(x)\)</span>. This property is very advantageous as there are many applications where there is not sufficient prior knowledge of heterogeneity to perform subgroup analysis. In this sense, causal trees are an exploratory research method with the powerful capabilities to find unknown subgroups.</p>
<div id="nte-confirmatory-exploratory-explan" class="callout callout-style-default callout-note callout-titled" title="Exploratory and Confirmatory Research">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;1: Exploratory and Confirmatory Research
</div>
</div>
<div class="callout-body-container callout-body">
<p>The distinction between exploratory and confirmatory research is important to ensure methods like CTs support <em>good science</em>. <span class="citation" data-cites="Schwab2020">Schwab and Held (<a href="#ref-Schwab2020" role="doc-biblioref">2020</a>)</span> note that exploratory research seeks to investigate and understand something without a predefined hypothesis, such as searching for HTEs. Some may describe exploratory research with derogatory terms such as “a fishing expedition” or “data dredging”. On the other hand, confirmatory research tests specific hypotheses derived from theory or prior knowledge. A summary is that exploratory research seeks to find “something”, while confirmatory aims to test a specific “thing”. The two are co-dependent, and both have value in research design.</p>
<p>Problems arise when exploratory and confirmatory research are accidentally confused or deliberately merged. Findings from exploratory research may result in false positives, indicating an effect where none exists. This can happen by chance, poor research design, or from completely spurious relationships. The false positive problem worsens as the amount of “exploration” increases, such as assessing more subgroups or using additional analysis methods. Additionally, a researcher may only present the interesting or convenient results leading to “cherry picking” of results. Additionally, the researcher may find the results and then specify the hypothesis as if it was previously known. This can be analogised as throwing darts then drawing the dartboard around the landing spot.</p>
<p>The two work best together in a research cycle where exploratory research generates hypothesis and confirmatory results tests them. Methods such as CTs can generate hypotheses, and confirmatory research can consider research design to test the hypothesis optimally as a part of a pre-registered study plan.</p>
</div>
</div>
</section>
<section id="sec-causal-tree-emse" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="sec-causal-tree-emse"><span class="header-section-number">1.1.2</span> Technical Detail and Splitting Criteria</h3>
<p>Typically a mean square error (MSE) function takes a form similar to <span class="math inline">\(\frac{1}{n}\sum(y_i-\hat{y_i})^2\)</span> where <span class="math inline">\(y_i\)</span> is the true value, <span class="math inline">\(\hat{y_i}\)</span> is the estimated value, and <span class="math inline">\(n\)</span> is the number of observations. Intuitively, the typical mean square error says to make the predicted values the closest to the actual values. The fundamental problem discussed in <strong>?@nte-fundamental</strong> means the MSE is not appropriate as we never observe true value of the individual treatment effect (ITE), denoted <span class="math inline">\(\tau_i\)</span>.</p>
<p>Recall from the introduction that a CT splits to maximise heterogeneity across nodes while minimising variance of the treatment effect within nodes. To maximise heterogeneity,the CT will maximise the variance of the predictions <a href="#eq-causal-tree-nodecalc" class="quarto-xref">Equation&nbsp;1</a> across all leaves. More variance across terminal nodes implies that the CT has found more heterogeneity of the treatment effect across the neighbourhoods identified by pseudo-matching. At the same time splits should be made so that the estimates of the treatment effect are robust and so the the splitting rule includes variance penalisation as well.</p>
<p>Putting these elements together, <span class="citation" data-cites="Athey2016">Athey and Imbens (<a href="#ref-Athey2016" role="doc-biblioref">2016</a>)</span> develop an expected mean square error function suitable for an unobserved <span class="math inline">\(\tau_i\)</span>:</p>
<p><span id="eq-ctemse"><span class="math display">\[
\begin{aligned}
    -\widehat{\operatorname{EMSE}}_\tau &amp; \left(\mathcal{S}^{tr}, N^{est}, \Pi\right) \equiv \alpha \frac{1}{N^{tr}} \sum_{\ell \in \Pi} \hat{\tau}^2\left(x ; \mathcal{S}^{tr}, \Pi\right)\\
    &amp;-(1-\alpha)\left(\frac{1}{N^{tr}}+\frac{1}{N^{est}}\right) \cdot \sum_{\ell \in \Pi}\left(\frac{\mathcal{S}_{\mathcal{S}_{\text {treat }}^{tr}}^2(\ell)}{p}+\frac{\mathcal{S}_{\mathcal{S}_{\text {control }}^{tr}}^2(\ell)}{1-p}\right).
\end{aligned}
\tag{2}\]</span></span></p>
<p>Let, - <span class="math inline">\(\frac{1}{N^{\operatorname{tr}}} \sum_{\ell \in \Pi} \hat{\tau}^2\left(x;\mathcal{S}^{\mathrm{tr}}, \Pi\right)\)</span> be the variance of the treatment effect across nodes in the training sample, <span class="math inline">\(\mathcal{S}^{\mathrm{tr}}\)</span> . This expression extends <a href="#eq-causal-tree-nodecalc" class="quarto-xref">Equation&nbsp;1</a> across all terminal leaves contained within the tree such that <span class="math inline">\(\ell_1,\ell_2 \dots\ell_n \in \Pi\)</span>.</p>
<ul>
<li><p><span class="math inline">\(N^\mathrm{tr} \text{ and } N^\mathrm{est}\)</span> be the number of observations in the training and estimation samples.</p></li>
<li><p><span class="math inline">\(\mathcal{S}^2 (\ell)\)</span> be the variance of the estimate of the treatment effect inside terminal node <span class="math inline">\(\ell\)</span>.</p></li>
<li><p><span class="math inline">\(p\)</span> be the treatment share expressed as <span class="math inline">\(N^\mathrm{tr}/ N^\mathrm{est}\)</span>.</p></li>
</ul>
<!-- clarify that the alpha parameter might not be implimented in athey2016 so note where it comes from in a footnote 

clarify that pi is inside the leaves initiaully before the eqn

also then state that inside eqation that it is only on the training obs, perhaps also that there is cross validation. -->
<ul>
<li><span class="math inline">\(\alpha\)</span> be a scalar controlling the relative contributions of each part of the equation.</li>
</ul>
<div id="nte-ctemse-intution" class="callout callout-style-default callout-note callout-titled" title="Relating back to Intuition">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;2: Relating back to Intuition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The intuition behind this complex error function is key to understanding causal trees. The first term is the estimated variance of the treatment effect across leaves by definition. Similar to the general definition of variance, it is the sum of the treatment effect across terminal nodes divided by the number of training observations. Each terminal node contributes to this term and an increase in the variance across terminal nodes indicates more heterogeneity of the treatment effect (it is more different across terminal nodes.). The second term is a measure of the variance of the treatment effects within each node.</p>
<p>The logic of the equation means that an increase in treatment effect heterogeneity between terminal nodes will reduce the (negative) of the <span class="math inline">\(\operatorname{EMSE}\)</span> and an increase in the uncertainty of the node estimates will increase the <span class="math inline">\(\operatorname{EMSE}\)</span>. Thus we can say that the <span class="math inline">\(\operatorname{EMSE}\)</span> equation will reward creating heterogeneous partitions and heterogeneous terminal nodes while also obtaining appropriate estimates of the treatment effects within each terminal node.</p>
</div>
</div>
<p><a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a> controls the relative strength of the two terms using the <span class="math inline">\(\alpha\)</span> parameter. A high value of <span class="math inline">\(\alpha\)</span> means that the variance of the treatment effect is less important. We expect that a higher <span class="math inline">\(\alpha\)</span> value will increase the depth of the trees as splits will ignore the variance of the estimated treatment effect. Contrastingly, <span class="math inline">\(\alpha=0\)</span> means that a tree will make no splits as this will make the variance of the treatment effect the lowest. If <span class="math inline">\(\alpha=1\)</span>, then trees are grown very deep and will continue to split until a defined number of minimum observations in each node is reached.</p>
<p>Interestingly, no pruning is required after the CT model is fit as the complexity of trees is implicitly included in <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a>. If a tree gets too complex, then the variance in the terminal node estimates will increase on unseen data in <span class="math inline">\(S^{est}\)</span>. The second part of <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a> punishes the model for an increase in variance in terminal nodes. Thus, the splits that lead to a relatively large variance of the <span class="math inline">\(\hat{\tau}(x;\ell_i)\)</span> will not be made. This variance penalisation also implies that small leaves will be penalised as small leaves lead to higher variance.</p>
</section>
<section id="cross-validation" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="cross-validation"><span class="header-section-number">1.1.3</span> Cross-Validation</h3>
<p>Cross validation does play an important role in a causal tree but not to the same extent as in CART. Cross validation is made complex as <span class="math inline">\(\tau_i\)</span> is unknown and there is not a test/train split present as in many other machine learning applications.</p>
<p>A CT requires honest cross validation so that the tree can discover the structure of the tree using unseen data. Noting that to make a split, the treatment effect must be evaluated in the potential child nodes. There is a cross-validation subset within <span class="math inline">\(\mathcal{S}^{tr}\)</span> that is used to evaluate <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a>. In other words, when training the tree to discover its structure, we use the cross validation set, <span class="math inline">\(\mathcal{S}^{cv}\)</span>, to evaluate splits. When doing this honest cross validation, the <span class="math inline">\(\widehat{\operatorname{EMSE}}\)</span> is the same as in <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a> but uses <span class="math inline">\(\mathcal{S}^{tr,cv}\)</span> instead of <span class="math inline">\(\mathcal{S}^{tr}\)</span>. Note that <span class="math inline">\(\mathcal{S}^{est}\)</span> is used after the tree is trained for the final estimation inside the terminal nodes.</p>
</section>
<section id="implimentation-inside-r-htetree" class="level3" data-number="1.1.4">
<h3 data-number="1.1.4" class="anchored" data-anchor-id="implimentation-inside-r-htetree"><span class="header-section-number">1.1.4</span> Implimentation inside R: <code>htetree</code></h3>
<p>A causal tree can be implemented inside R using the <code>htetree</code> package which provides a large library of functions for estimating heterogeneous treatment effects with tree-based machine learning algorithms as well as visualisation.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> This package uses <code>rpart</code> which is a common implementation of CART in R.</p>
<p>My exposition of the CT method does not explore the results of the analysis in depth as this is explored further in the <span class="citation" data-cites="sec">(<a href="#ref-sec" role="doc-biblioref"><strong>sec?</strong></a>)</span>-. I perform a basic fit which demonstrates the implementation followed by a simple visualisation which reinforces the intuition of a causal tree.</p>
<div class="sourceCode" id="annotated-cell-1"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">88</span>)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-1-2" class="code-annotation-target"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="annotated-cell-1-3"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a>nsw_split <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(nsw_data<span class="sc">$</span>data_id, <span class="at">p=</span><span class="fl">0.7</span>,</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a>nsw_train <span class="ot">&lt;-</span> nsw_data[nsw_split,]</span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a>nsw_est <span class="ot">&lt;-</span> nsw_data[<span class="sc">-</span>nsw_split,]</span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-1-8" class="code-annotation-target"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htetree)</span>
<span id="annotated-cell-1-9"><a href="#annotated-cell-1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-1-10" class="code-annotation-target"><a href="#annotated-cell-1-10" aria-hidden="true" tabindex="-1"></a>nsw_causalTree <span class="ot">&lt;-</span> <span class="fu">honest.causalTree</span>(re78 <span class="sc">~</span> age <span class="sc">+</span> educ <span class="sc">+</span></span>
<span id="annotated-cell-1-11"><a href="#annotated-cell-1-11" aria-hidden="true" tabindex="-1"></a>                                    black <span class="sc">+</span> hisp <span class="sc">+</span> degree <span class="sc">+</span> marr,</span>
<span id="annotated-cell-1-12"><a href="#annotated-cell-1-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">data =</span> nsw_train,</span>
<span id="annotated-cell-1-13"><a href="#annotated-cell-1-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">treatment =</span> nsw_train<span class="sc">$</span>treat,</span>
<span id="annotated-cell-1-14"><a href="#annotated-cell-1-14" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">est_data =</span> nsw_est,</span>
<span id="annotated-cell-1-15"><a href="#annotated-cell-1-15" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">est_treatment =</span> nsw_est<span class="sc">$</span>treat,</span>
<span id="annotated-cell-1-16"><a href="#annotated-cell-1-16" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">split.Rule =</span> <span class="st">"CT"</span>, <span class="at">split.Honest =</span> T,</span>
<span id="annotated-cell-1-17"><a href="#annotated-cell-1-17" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">HonestSampleSize =</span> <span class="fu">nrow</span>(nsw_est),</span>
<span id="annotated-cell-1-18"><a href="#annotated-cell-1-18" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">cv.option =</span> <span class="st">"CT"</span>, <span class="at">split.alpha =</span> <span class="fl">0.5</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-1-19" class="code-annotation-target"><a href="#annotated-cell-1-19" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">minsize =</span> <span class="dv">5</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="2,3,4,5,6" data-code-annotation="1">The data is split into the training and estimation set as required to fit an honest tree. This is done using the <code>createDataPartition</code> function in the <code>caret</code> package. Following a common rule-of-thumb, 70% of the data is used for training and 30% is used for estimation.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="8,9" data-code-annotation="2">The <code>htetree</code> and <code>rpart</code> packages are loaded. Both are required to fit an <code>honest.causalTree</code> as <code>htetree</code> uses <code>rpart</code> to fit the model.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="10,11,12,13,14,15,16,17,18" data-code-annotation="3">The parameters of the <code>honest.causalTree</code> function are specified. The process of specifying some of these objects is cumbersome.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="19" data-code-annotation="4">I have specified <code>minsize = 5</code> meaning that each node must contain <span class="math inline">\(5\)</span> or more cases of both treated and control observations. <em>This is set for ease of visualisation not advantageous model fit.</em></span>
</dd>
</dl>
<div class="cell">
<details class="code-fold">
<summary>Show the Code to Visualise the Causal Tree.</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code creates the rpart plot to visualise Figure 1plageholder</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot) </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(nsw_causalTree, <span class="at">yesno =</span> <span class="dv">2</span>, <span class="at">shadow.col =</span> <span class="st">"grey"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">prefix =</span> <span class="st">"CATE:"</span>, <span class="at">main =</span> <span class="st">"NSW Causal Tree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-causalTree" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-causalTree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="trees_files/figure-html/fig-causalTree-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-causalTree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: This visualisation shows the splits selected by the Causal Tree. Darker shaded nodes correspond to a higher estimate of the CATE. Percentages indicate the percent of observations falling into a given node.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the Code to Visualise the Causal Tree.</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code creates the rpart plot to visualise Figure placeholder</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>age_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(nsw_data<span class="sc">$</span>age), <span class="fu">max</span>(nsw_data<span class="sc">$</span>age), <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>educ_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(nsw_data<span class="sc">$</span>educ), <span class="fu">max</span>(nsw_data<span class="sc">$</span>educ), <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">age =</span> age_seq,<span class="at">educ =</span> educ_seq)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>mean_values <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(nsw_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>other_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(nsw_data)[<span class="sc">!</span>(<span class="fu">names</span>(nsw_data) <span class="sc">%in%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"educ"</span>, <span class="st">"response"</span>))]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> other_vars) {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>grid[[var]] <span class="ot">&lt;-</span> mean_values[var]}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>response <span class="ot">&lt;-</span> <span class="fu">predict</span>(nsw_causalTree, <span class="at">newdata =</span> grid)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>response_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(grid<span class="sc">$</span>response, <span class="at">nrow =</span> <span class="fu">length</span>(educ_seq),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">length</span>(age_seq))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>age_seq,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>educ_seq,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="sc">~</span>response_matrix,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'surface'</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">colorscale =</span> <span class="fu">list</span>(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>, <span class="st">'rgb(0, 0, 255)'</span>), <span class="co"># Dark blue</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="st">'rgb(0, 255, 255)'</span>),<span class="co"># Cyan</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="st">'rgb(0, 255, 0)'</span>)), <span class="co"># Green</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">showscale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>camera <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">eye =</span> <span class="fu">list</span>(<span class="at">x=</span><span class="sc">-</span><span class="fl">1.6</span>, <span class="at">y=</span><span class="fl">1.6</span>, <span class="at">z=</span><span class="fl">1.1</span>),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">center =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">0</span>),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">up =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">1</span>))</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Age'</span>),</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Education'</span>),</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"ITE in $'s"</span>),</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">camera =</span> camera),</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">'3D Response Surface of Decision Tree: Age vs Education'</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-causalTree-3d" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-causalTree-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-439996ec5e688a47b023" style="width:100%;height:500px;"></div>
<script type="application/json" data-for="htmlwidget-439996ec5e688a47b023">{"x":{"visdat":{"78c471623cfa":["function () ","plotlyVisDat"]},"cur_data":"78c471623cfa","attrs":{"78c471623cfa":{"x":{},"y":{},"z":{},"colorscale":[["0","rgb(0, 0, 255)"],["0.25","rgb(0, 255, 255)"],["0.5","rgb(0, 255, 0)"]],"showscale":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Age"},"yaxis":{"title":"Education"},"zaxis":{"title":"ITE in $'s"},"camera":{"eye":{"x":-1.6000000000000001,"y":1.6000000000000001,"z":1.1000000000000001},"center":{"x":0,"y":0,"z":0},"up":{"x":0,"y":0,"z":1}}},"title":"3D Response Surface of Decision Tree: Age vs Education","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"response_matrix","ticklen":2},"colorscale":[["0","rgb(0, 0, 255)"],["0.25","rgb(0, 255, 255)"],["0.5","rgb(0, 255, 0)"]],"showscale":false,"x":[17,17.775510204081634,18.551020408163264,19.326530612244898,20.102040816326529,20.877551020408163,21.653061224489797,22.428571428571431,23.204081632653061,23.979591836734691,24.755102040816325,25.530612244897959,26.306122448979593,27.081632653061224,27.857142857142858,28.632653061224488,29.408163265306122,30.183673469387756,30.959183673469386,31.73469387755102,32.510204081632651,33.285714285714285,34.061224489795919,34.836734693877546,35.612244897959187,36.387755102040813,37.163265306122447,37.938775510204081,38.714285714285715,39.489795918367349,40.265306122448976,41.04081632653061,41.816326530612244,42.591836734693878,43.367346938775512,44.142857142857139,44.918367346938773,45.693877551020407,46.469387755102041,47.244897959183675,48.020408163265301,48.795918367346943,49.571428571428569,50.346938775510203,51.122448979591837,51.897959183673471,52.673469387755098,53.448979591836732,54.224489795918366,55],"y":[3,3.2653061224489797,3.5306122448979593,3.795918367346939,4.0612244897959187,4.3265306122448983,4.591836734693878,4.8571428571428577,5.1224489795918373,5.387755102040817,5.6530612244897966,5.9183673469387763,6.1836734693877551,6.4489795918367347,6.7142857142857144,6.9795918367346941,7.2448979591836737,7.5102040816326534,7.7755102040816331,8.0408163265306136,8.3061224489795933,8.571428571428573,8.8367346938775526,9.1020408163265323,9.3673469387755102,9.6326530612244898,9.8979591836734695,10.163265306122449,10.428571428571429,10.693877551020408,10.959183673469388,11.224489795918368,11.489795918367347,11.755102040816327,12.020408163265307,12.285714285714286,12.551020408163266,12.816326530612246,13.081632653061225,13.346938775510205,13.612244897959185,13.877551020408164,14.142857142857144,14.408163265306124,14.673469387755103,14.938775510204083,15.204081632653063,15.469387755102042,15.73469387755102,16],"z":[[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417,2134.2801902077417],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836],[-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,-1622.3884338378912,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836,1206.1063216771836]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-causalTree-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The interaction between age and education is shown in the response surface of the causal tree. The visualisation is interactive when viewing as a .html file type
</figcaption>
</figure>
</div>
</div>
<p>To produce <a href="#fig-causalTree-3d" class="quarto-xref">Figure&nbsp;3</a>, all other variables have been held constant at their mean values. This is not a problem as the splits involving age and education do not interact with any other covariates.</p>
<p>The CT algorithm has identified heterogeneous subgroups and has calculated <span class="math inline">\(\hat{\tau}(x)\)</span> for heterogeneous subgroups. However, CT have some similar drawbacks to regular CART models. First, this is a <em>greedy</em> algorithm meaning that splits at earlier points are made without consideration of later splits. Secondly, the algorithm is likely to lead to quite sharp decision boundaries as visualised in <a href="#fig-causalTree-3d" class="quarto-xref">Figure&nbsp;3</a>. In this example, an individual is younger than <span class="math inline">\(26\)</span>, an increase in education from <span class="math inline">\(10\)</span> to <span class="math inline">\(11\)</span> results in a completely different <span class="math inline">\(\hat{\tau}(x)\)</span>. This is unrealistic and smoother smooth decision boundaries should better replicate the real world.</p>
</section>
<section id="sec-towards-causal-forests" class="level3" data-number="1.1.5">
<h3 data-number="1.1.5" class="anchored" data-anchor-id="sec-towards-causal-forests"><span class="header-section-number">1.1.5</span> Towards a Causal Forest</h3>
<p>The next natural development upon causal trees (CT) is a causal forest (CF). Theoretically, a CF is preferable to a CT because ensemble learning methods such as random forest (RF) typically result in superior performance. An ensemble of CTs should smooth sharp decision boundaries, leading to much better estimates of <span class="math inline">\(\tau(x)\)</span>. Consider <span class="math inline">\(\tau(x)\)</span> to be a continuous CATE function in the context of a causal forest.</p>
<p><span class="citation" data-cites="Wager2018hterf">Wager and Athey (<a href="#ref-Wager2018hterf" role="doc-biblioref">2018</a>)</span> present a simple implementation of a CF that averages the predictions from many individual CTs, each optimising the <span class="math inline">\(\operatorname{EMSE}\)</span> from <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a>. Following the conventional philosophy of random forest as in <span class="citation" data-cites="Breiman2001">Brieman (<a href="#ref-Breiman2001" role="doc-biblioref">2001</a>)</span>, averaging the predictions across diverse trees should lead to improved predictions and smooth decision boundaries. The final prediction from this implementation of a CF is <span class="math inline">\(\hat{\tau}(x)=\frac{\sum_{b=1}^B\hat{\tau_b}(x)}{B}\)</span> where <span class="math inline">\(B\)</span> is the number of trees and <span class="math inline">\(\hat{\tau_b}(x)\)</span> is the CATE calculated by each base tree.</p>
<p>Random forests achieve diverse trees by fitting each tree on a bootstrapped sample of the data. In other words, each tree is grown with different observations, leading to more tree diversity. Fitting individual trees with bootstrapped observations is often referred to as <em>bagging</em> or <em>bootstrap aggregation</em>, which was introduced by <span class="citation" data-cites="Breiman1996">Breiman (<a href="#ref-Breiman1996" role="doc-biblioref">1996</a>)</span>. To further encourage tree diversity, several randomly selected variables are considered at each split to reduce the correlation between trees further. Splitting on different variables at each split prevents strong predictors from always being the initial variables selected, allowing trees to model interactions between other variables.</p>
<p>A CF cannot directly identify subgroups as the overall prediction is an individual treatment effect. The only reason CTs can identify subgroups is because sharp boundaries define heterogeneous groups. In a CT, averaging of predictions should smooth boundaries, thus making subgroups not directly interpretable.</p>
<p>A key contribution of <span class="citation" data-cites="Wager2018hterf">Wager and Athey (<a href="#ref-Wager2018hterf" role="doc-biblioref">2018</a>)</span> is the asymptotic normality of random forests, enabling valid statistical inference. The predictions made by a causal forest are asymptotically normal and unbiased, provided unconfoundedness and common support assumptions are met. The variance predictions from a CF can be estimated using a jackknife procedure developed by <span class="citation" data-cites="Wager2014">Wager, Hastie, and Efron (<a href="#ref-Wager2014" role="doc-biblioref">2014</a>)</span>, and the estimation of confidence intervals is possible.</p>
<!-- clarify what the contirbution of wager is. give the context of what their normality proof is -->
<p>While this implementation of a CF is appealing, there are two downsides. First, the predictions from a CF may be poor as individual CTs may be biased even when using sample splitting due to low sample size or poor tuning of the CT algorithm. Additionally, errors from tree predictions of <span class="math inline">\(\hat{\tau}(x)\)</span> may be so large that the average across tree predictions is still a poor estimate of the treatment effect. Secondly, computing splits for each tree is very time-consuming, given that <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a> is a highly complex function. These weaknesses and a desire for a generalised approach led <span class="citation" data-cites="Athey2019grf">Athey, Tibshirani, and Wager (<a href="#ref-Athey2019grf" role="doc-biblioref">2019</a>)</span> to develop the Generalized Random Forest.</p>
</section>
</section>
<section id="sec-grf-basics" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sec-grf-basics"><span class="header-section-number">1.2</span> Generalized Random Forests: Overview and Intuition</h2>
<p>Causal forests belong to a family of forests called <em>Generalized Random Forests</em> (GRF), introduced by <span class="citation" data-cites="Athey2019grf">Athey, Tibshirani, and Wager (<a href="#ref-Athey2019grf" role="doc-biblioref">2019</a>)</span>. As suggested in the name, these forests are a generalization of a random forest (RF) suited to diverse applications such as survival analysis or instrumental variable methods. At first, I first provide a simple overview of GRF and omit the details of implementation to simplify my explanation. Then, I introduce GRF on a technical level in <a href="#sec-grf-technical" class="quarto-xref">Section&nbsp;1.2.1</a>. However, the following explanation does not replace studying the original paper <span class="citation" data-cites="Athey2019grf">Athey, Tibshirani, and Wager (<a href="#ref-Athey2019grf" role="doc-biblioref">2019</a>)</span>.</p>
<div id="nte-cf-implimentation-differences" class="callout callout-style-default callout-note callout-titled" title="Different Implimentations of a Causal Forest">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;3: Different Implimentations of a Causal Forest
</div>
</div>
<div class="callout-body-container callout-body">
<p>To be very clear, the implementation of a CF in a GRF framework is different than a simple average of trees discussed in <a href="#sec-towards-causal-forests" class="quarto-xref">Section&nbsp;1.1.5</a>. More specifically, the implementation of causal forests in <span class="citation" data-cites="Wager2018hterf">Wager and Athey (<a href="#ref-Wager2018hterf" role="doc-biblioref">2018</a>)</span> and <span class="citation" data-cites="Athey2019grf">Athey, Tibshirani, and Wager (<a href="#ref-Athey2019grf" role="doc-biblioref">2019</a>)</span> are different. The implementation in the <code>grf</code> software follows <span class="citation" data-cites="Athey2019grf">Athey, Tibshirani, and Wager (<a href="#ref-Athey2019grf" role="doc-biblioref">2019</a>)</span>. An “honest causal forest” using averages can be implemented with the <code>htetree</code> package. The distinction between the implementations is commonly mistaken in the literature and care must be taken when discussing these methods as the literature continues to develop. Notably, <span class="citation" data-cites="Jawadekar2023">Jawadekar et al. (<a href="#ref-Jawadekar2023" role="doc-biblioref">2023</a>)</span> make the mistake of conflating the two implementations in their paper which aimed to clarify the implimentation of a causal forest.</p>
</div>
</div>
<p>Recall from <a href="#sec-causal-tree-intro" class="quarto-xref">Section&nbsp;1.1</a> that a causal tree can be analogised to a neighbourhood pseudo-matching method where observations in the same terminal node are “matched” together. <span class="citation" data-cites="Athey2019grf">Athey, Tibshirani, and Wager (<a href="#ref-Athey2019grf" role="doc-biblioref">2019</a>)</span> take the neighbourhood analogy further and consider GRF to be an “adaptive locally weighted estimator that first uses a forest to calculate a weighted set of neighbours for each test point, then solve a plug-in version of a [local estimating equation]”. Conceptually, a local estimating equation is like an equation to calculate the treatment effect but optimised locally allowing it to represent HTEs. Different specifications of the GRF framework are implemented by changing the form of the estimating equation.</p>
<p>The <em>forest</em> part of a GRF develops a weighting scheme that defines how similar observations are to each other. A single tree can create groups of observations inside nodes in a neighbourhood characterised by splits leading to the terminal node. For example, a neighbourhood in <a href="#fig-ctree" class="quarto-xref">Figure&nbsp;1</a> comprises observations falling into each terminal node. Instead of a binary “in the neighbourhood” or “outside the neighbourhood”, a forest provides a scale of closeness defined by weights. The weights for an arbitrary observation, <span class="math inline">\(x\)</span>, capture the frequency of when that observation falls into the same terminal node as other observations in each tree inside the forest.</p>
<p>To estimate these weights, A GRF uses a modified random forest called GradientForest that incorporates a gradient descent process at each split to maximise the observations’ total “influence” upon the parameter estimates. Each tree is grown to be “deep” using this influence-based splitting rule and a gradient descent sequence. Notably, <span class="math inline">\(\operatorname{EMSE}\)</span> from <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a> does not feature in the GRF algorithm as it is difficult to optimise and does fit the framework of a GRF.</p>
<p>A GRF uses these similarity weights to evaluate a local estimating equation that captures heterogeneity of a treatment effect. Framing random forests as a method to estimate similarity weights contradicts conventional random forests. Typically, a random forest grows many trees and then averages the predictions so that the average of each tree is a much better model than any individual tree. In GRF, each tree is used to compute weights to solve a locally-weighted heterogeneous equation.</p>
<section id="sec-grf-technical" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="sec-grf-technical"><span class="header-section-number">1.2.1</span> Technical Explanation of GRF</h3>
<p>Keeping neighbourhood finding in mind, consider that there exists some heterogeneous estimating equation in the form of a localised generalized method of moments (LGMM) estimator, as in <span class="citation" data-cites="Lewbel2007">Lewbel (<a href="#ref-Lewbel2007" role="doc-biblioref">2007</a>)</span>. This LGMM equation is of the general form:</p>
<p><span id="eq-grf-lgmm"><span class="math display">\[
\mathbb{E}\left[\psi_{\theta(x), \nu(x)} \mid X = x\right] = 0,
\tag{3}\]</span></span></p>
<!-- more detail on what the expectation is equal to zero means  -->
<p>where <span class="math inline">\(\psi_{\theta(x), \nu(x)}\)</span> is a moment condition that I refer to as the score function. Specifically, <span class="math inline">\(\theta(x)\)</span> is an estimator of some desirable quantity such as a conditional mean, quantile or average partial effect and <span class="math inline">\(\nu\)</span> is a nuisance parameter that exists in some specifications of a GRF. <a href="#eq-grf-lgmm" class="quarto-xref">Equation&nbsp;3</a> must hold for the local parameter estimates <span class="math inline">\(\theta(x)\)</span> to be unbiased and consistent.</p>
<div id="nte-primer-mm" class="callout callout-style-default callout-note callout-titled" title="A Quick Primer on Method of Moment Estimation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;4: A Quick Primer on Method of Moment Estimation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Method of Moments (MoM) estimation is a method to estimate parameters in the form of moments. The method consists of equating theoretical moments to sample calculations (sometimes called an empirical moment). For example, the first moment, <span class="math inline">\(E[X]\)</span> is the mean with the sample calculation <span class="math inline">\(\hat{\mu}=\frac{1}{n}\sum^n_{i=1} x_i\)</span>. Generalized Method of Moments (GMM) extends MoM by incorporating multiple moment conditions and a weighting matrix, allowing for more efficient and robust parameter estimation and when there are more moment conditions than parameters. Local Generalized Method of Moments (LGMM) further extends GMM by applying moment conditions locally, using a weighting matrix to focus on localities of data. This approach can capture heterogeneity and provide parameter estimates that vary smoothly across the sample, making it useful for modelling heterogeneous treatment effects.</p>
</div>
</div>
<p>The solution to the LGMM estimator is found at some optimisation value. In a CF, the desirable quantity is the CATE. A GRF solves an LGMM estimator using weights, <span class="math inline">\(\alpha_i(x)\)</span> provided by a GradientForest to obtain a smooth response surface where the global variation in the surface represents treatment effect heterogeneity. The solution to the local equation is</p>
<p><span id="eq-grf-lgmm-solution"><span class="math display">\[
\left( \hat{\theta}(x), \hat{\nu}(x) \right) \in \arg\min_{\theta, \nu} \left\| \sum_{i=1}^n \alpha_i(x) \psi_{\theta, \nu}(O_i) \right\|_2.
\tag{4}\]</span></span></p>
<p>A GRF can model any quantity of interest identified by a local moment condition. To specify the type of GRF, there must be an empirical version of the local moment equation to optimise. For example, in a conventional regression random forest, this local estimation equation is simply the residual sum of squares (RSS), and so a GRF implementation of a regression random forest is practically identical to the standard implementation as in <code>randomForest</code>.</p>
<p>As the success of this method relies on estimating weights that represent heterogeneity, the forest used to calculate these weights is not a typical RF. As mentioned above, a GradientForest is optimised to create heterogeneous splits while also being computationally efficient. Being a <em>generalized</em> method, this splitting rule can take many forms but should encourage heterogeneity so the resulting weights can represent the heterogeneity of the treatment effect.</p>
<p>To make computation possible, <span class="citation" data-cites="Athey2019grf">Athey, Tibshirani, and Wager (<a href="#ref-Athey2019grf" role="doc-biblioref">2019</a>)</span> implement a gradient descent process where the gradient of <span class="math inline">\(\psi_{\hat{\theta}_P, \hat{\nu}_P}\)</span> is computed once at each split. Let <span class="math inline">\(\hat{\theta}_P\)</span> and <span class="math inline">\(\hat{\nu}_P\)</span> be estimates of <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\nu\)</span> in parent node, <span class="math inline">\(P\)</span>. Each tree separately performs a gradient descent procedure similar to a Gradient Boosting Machine (GBM) introduced by <span class="citation" data-cites="Friedman2001">Friedman (<a href="#ref-Friedman2001" role="doc-biblioref">2001</a>)</span>. The key difference is that a GBM computes the gradient once per tree and sequentially descends a loss function across the whole ensemble. In a GradientForest, each split is an iteration towards the minimum of the splitting rule, and each tree separately performs gradient descent. In other words, a GBM descends from tree to tree while a GRF descends from split to split within each tree.</p>
<p>The GRF gradient descent process iteratively applies two steps. First is creating what <span class="citation" data-cites="Athey2019grf">Athey, Tibshirani, and Wager (<a href="#ref-Athey2019grf" role="doc-biblioref">2019</a>)</span> describe as pseudo-outcomes in a “relabelling step”. Inside each parent node, <span class="math inline">\(P\)</span>, the LGMM estimator in <a href="#eq-grf-lgmm-solution" class="quarto-xref">Equation&nbsp;4</a> is solved without weights to estimate the desirable quantity <span class="math inline">\(\hat{\theta}(x)\)</span>. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Also, the Hessian matrix of <span class="math inline">\(\psi_{\hat{\theta}_P, \hat{\nu}_P}\)</span> is computed once inside a parent node. This matrix <span class="math inline">\(A_P\)</span> is the Hessian matrix <span class="math inline">\(\nabla \psi_{\hat{\theta}_P, \hat{\nu}_P}\)</span> evaluated in <span class="math inline">\(P\)</span>, normalised over the number of observations inside the parent node:</p>
<p><span id="eq-grf-hessian-matrix"><span class="math display">\[
A_P = \frac{1}{|\{i : x_i \in P\}|} \sum_{\{i : x_i \in P\}} \nabla \psi_{\hat{\theta}_P, \hat{\nu}_P}(O_i).
\tag{5}\]</span></span></p>
<p>To calculate pseudo-outcomes, let <span class="math inline">\(-\xi^\top\)</span> be a operator that “picks out” the vector of <span class="math inline">\(\hat{\theta}(x)\)</span> from a the matrix. Pseudo-outcomes are a combination of the score function and the Hessian matrix of the score function evaluated at the current <span class="math inline">\(\theta(x)\)</span> estimate using observations within the parent node:</p>
<p><span id="eq-grf-pseudo-outcomes"><span class="math display">\[
\rho_i = -\xi^\top A_P^{-1} \psi_{\hat{\theta}_P, \hat{\nu}_P}(O_i).
\tag{6}\]</span></span></p>
<p>Pseudo-outcomes are analogous to pseudo-residuals in a GBM. Additionally, pseudo-outcomes are a measure of influence that measures how much the omission of observation <span class="math inline">\(i\)</span> changes the parameter estimate.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>Viewing these pseudo-outcomes as influence measures, splits that maximise the level of influence in the child nodes should approximately correspond to splitting directly for the desirable quantity. Being a generalized method, the intuitive representation of <span class="math inline">\(\rho_i\)</span> depends on the nature of the score function. If <span class="math inline">\(\psi_{\hat{\theta}_P, \hat{\nu}_P}(O_i)\)</span> is the RSS, then splitting to maximise <span class="math inline">\(\rho_i\)</span> is approximately equivalent to splitting to minimise RSS. If <span class="math inline">\(\psi_{\hat{\theta}_P, \hat{\nu}_P}(O_i)\)</span> is some equation to represent heterogeneity, then maximising <span class="math inline">\(\rho_i\)</span> is approximately equivalent to splitting directly for heterogeneity.</p>
<p>Splitting to maximise the total influence across all observations is computationally efficient compared to optimising a complex function such as <a href="#eq-ctemse" class="quarto-xref">Equation&nbsp;2</a>. Specifically, the calculation of the split is normalised over the number of observations in each child node <span class="math inline">\(C_j\)</span>. Let <span class="math inline">\(\tilde{\Delta}(C_1, C_2)\)</span> be a measure of influence in the child nodes:</p>
<p><span id="eq-grf-splitting-rule"><span class="math display">\[
\tilde{\Delta}(C_1, C_2) = \sum_{j=1}^2 \frac{1}{|\{i : x_i \in C_j\}|} \left( \sum_{\{i : x_i \in C_j\}} \rho_i \right)^2.
\tag{7}\]</span></span></p>
<p>The GRF algorithm grows the first of many diverse trees by greedily splitting data. As in <a href="#sec-towards-causal-forests" class="quarto-xref">Section&nbsp;1.1.5</a>, each tree uses a bootstrapped sample of data, and each split uses a certain number of randomly selected variables.</p>
<p>Let the set of <span class="math inline">\(B\)</span> trees inside the forest be indexed as <span class="math inline">\(b=1,\dots, B\)</span> and let <span class="math inline">\(L_b(x)\)</span> be the set of observations that fall into the same terminal node as arbitrary value <span class="math inline">\(x\)</span>. Weights <span class="math inline">\(\alpha_i(x)\)</span> capture the frequency with which the <span class="math inline">\(i\)</span>th training example falls into the same terminal node as <span class="math inline">\(x\)</span> such that</p>
<p><span id="eq-grf-weights"><span class="math display">\[
\alpha_i(x) = \frac{1}{B} \sum_{b=1}^B \frac{\mathbf{1}\{x_i \in L_b(x)\}}{|L_b(x)|},
\tag{8}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{1}\)</span> is an indicator function equal to <span class="math inline">\(1\)</span> if <span class="math inline">\(x_i\)</span> is in the same node as arbitrary point <span class="math inline">\(x\)</span> and <span class="math inline">\(|L_b(x)|\)</span> is the number of observations in the node where <span class="math inline">\(x\)</span> falls. For every observation where the score function is evaluated, a corresponding weight matrix defines how similar that point is to all other points in the data. As previously mentioned, these weights are used to solve <a href="#eq-grf-lgmm-solution" class="quarto-xref">Equation&nbsp;4</a> to obtain <span class="math inline">\(\hat{\theta}(x)\)</span>.</p>
</section>
<section id="causal-forests-in-the-general-framework" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="causal-forests-in-the-general-framework"><span class="header-section-number">1.2.2</span> Causal Forests in the General Framework</h3>
<p>Recall from <strong>?@sec-background-linear</strong> that a model describes the linear relationship between the treatment, covariates, and outcome, as in <strong>?@eq-linear-model</strong>. Instead, suppose a non-linear relationship exists between covariates and outcomes and heterogeneous treatment effects. This model is stated as</p>
<p><span id="eq-nonlinear-heterogeneous"><span class="math display">\[
Y=\tau(x)T+f(x)+\epsilon,
\tag{9}\]</span></span></p>
<p>where <span class="math inline">\(\tau(x)\)</span> is the CATE and <span class="math inline">\(f(x)\)</span> is a function describing the relationship between covariates and the outcome. Recall from <strong>?@sec-propensity</strong> that the propensity score reduces the dimension of <span class="math inline">\(f(x)\)</span> to a single propensity score, <span class="math inline">\(e(x)\)</span>. However, a propensity score approach does not allow for HTEs. In the framework of a GRF, <span class="math inline">\(\tau(x)\)</span> is solved using weights defined by the GradientForest procedure to estimate <a href="#eq-grf-lgmm" class="quarto-xref">Equation&nbsp;3</a>.</p>
<p>Estimating <a href="#eq-nonlinear-heterogeneous" class="quarto-xref">Equation&nbsp;9</a> seems simple but is theoretically problematic. Conceptually, a model must “understand” some elements of the data to identify HTEs. First, it must model the effect of the covariates on the outcome and potential interactions between covariates so treatment effects are isolated. Second, it must model the relationships between covariates and the treatment as these relationships drive heterogeneity. Third, it should model the conditional effect of the covariates on the probability of being treated so estimates are not subject to confounding. Finally, it must also estimate weights, <span class="math inline">\(\alpha_i(x)\)</span>, that result in good estimates of the local equation. Using a single model risks “overwhelming” the model, leading to sub-optimal weights and poor treatment effect estimation. To simplify the estimation, a causal forest uses an approach called “local centering” or orthogonalisation, introduced by <span class="citation" data-cites="Robinson1988">Robinson (<a href="#ref-Robinson1988" role="doc-biblioref">1988</a>)</span>. A Robinson transformation will “regress out” the conditional effects of the covariates on the outcome and treatment indicator.</p>
<p>Let <span class="math inline">\(\mu(x)\)</span> be the conditional outcome such that</p>
<p><span id="eq-grf-conditional-outcome"><span class="math display">\[
\mu(x) = E[Y|X=x]=f(x)+\tau(x)e(x).
\tag{10}\]</span></span></p>
<p>Subtracting the conditional outcome, <span class="math inline">\(\mu(x)\)</span>, orthogonalises <a href="#eq-nonlinear-heterogeneous" class="quarto-xref">Equation&nbsp;9</a>:</p>
<p><span class="math display">\[
\begin{aligned}
Y&amp;=\tau(x)T+f(x)+\epsilon\\
Y - \mu(x)&amp;=\tau(x)T+f(x)-m(x)+\epsilon\\
Y - \mu(x)&amp;=\tau(x)T+f(x)-(f(x)+\tau(x)e(x))+\epsilon\\
Y - \mu(x)&amp;=\tau(x)(T-e(x))+ \epsilon
\end{aligned}
\]</span></p>
<p>In the <code>grf</code> package, the <code>causal_forest</code> function estimates <span class="math inline">\(\hat{e}^{(-i)}(x)\)</span> and <span class="math inline">\(\hat{m}^{(-i)}(x)\)</span> using separate regression forests and then plugs the estimates into in the orthogonalised function:</p>
<p><span id="eq-orthogonalised-function"><span class="math display">\[
Y -\hat{m}^{(-i)}(x) =\tau(x)(T-\hat{e}^{(-i)}(x))+ \epsilon.
\tag{11}\]</span></span></p>
<p>The superscript <span class="math inline">\(^{(-i)}\)</span> indicates that the estimate for <span class="math inline">\(i\)</span> is made on a sample not including <span class="math inline">\(i\)</span>. <span class="citation" data-cites="Nie2021">Nie and Wager (<a href="#ref-Nie2021" role="doc-biblioref">2021</a>)</span> develop a loss function for treatment effect estimation of this general form. Derived from <a href="#eq-orthogonalised-function" class="quarto-xref">Equation&nbsp;11</a>, the score function is</p>
<p><span id="eq-grf-cf-score"><span class="math display">\[
\psi_{\tau}= (Y - \hat{m}^{(-i)}(x) - \tau(T - \hat{e}^{(-i)}(x)))(T - \hat{e}^{(-i)}(x)),
\tag{12}\]</span></span></p>
<p>with the moment condition defined by: <span id="eq-grf-cf-moment-condition"><span class="math display">\[
E[Y - \hat{m}^{(-i)}(x) - \tau(T - \hat{e}^{(-i)}(x)))(T - \hat{e}^{(-i)}(x)] = 0.
\tag{13}\]</span></span></p>
<p><span class="citation" data-cites="Robinson1988">Robinson (<a href="#ref-Robinson1988" role="doc-biblioref">1988</a>)</span> shows us that an orthogonalisation approach is theoretically advantageous as noisy estimates of <span class="math inline">\(\hat{m}^{(-i)}(x)\)</span> and <span class="math inline">\(\hat{e}^{(-i)}(x)\)</span> will still lead to good estimates of <span class="math inline">\(\tau(x)\)</span>. Particularly, <span class="math inline">\(\hat{m}^{(-i)}(x)\)</span> and <span class="math inline">\(\hat{e}^{(-i)}(x)\)</span> can converge at a slower rate but <span class="math inline">\(\hat{\tau}(x)\)</span> remains robust. Additionally, by specifying <span class="math inline">\(e(x)\)</span>, the CF should be robust to confounding provided that <strong>?@eq-conditional-independence</strong> is satisfied.</p>
<p>Finally, the final definition of a causal forest is the optimisation of</p>
<p><span id="eq-grfcf-solution"><span class="math display">\[
\hat{\tau}(x) \in \arg\min_{\tau} \left\| \sum_{i=1}^n \alpha_i(x) (Y - \hat{m}^{(-i)}(x) - \tau(T - \hat{e}^{(-i)}(x)))(T - \hat{e}^{(-i)}(x)) \right\|_2,
\tag{14}\]</span></span></p>
<p>using weights, <span class="math inline">\(\alpha_i(x)\)</span>, obtained through a GradientForest.</p>
<!-- -score functions (clarify if score functions are moment conditions in terms of LGMM?) -->
<!-- - It is also worth noting that this GRF is closely related to local kernel regression.  -->
<!-- - honesty and the asymptotics, particularly in relation to cf -->
<!-- - inference -->
<!-- need to look into the sharp cutoff boundries that seem prevalent in the grf in this data. look more into local linear forests and random forests in the "things economists should know" paper by athet.  -->
</section>
<section id="other-generalised-random-forests-algorithems-inside-grf" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="other-generalised-random-forests-algorithems-inside-grf"><span class="header-section-number">1.2.3</span> Other Generalised Random Forests Algorithems Inside <code>grf</code></h3>
<p>The <code>grf</code> package provides a range of random forest implementations including <code>causal_forest</code>, <code>survival_forest</code>, <code>instrument_forest</code>, <code>quantile_forest</code>, and <code>probability_forest</code>. There is notable documentation provided on the <a href="https://grf-labs.github.io/grf/">package Github</a>.</p>
</section>
</section>
<section id="application-national-supported-work-data-dont-read-some-things-have-run-into-errors-which-will-hopefully-be-a-simple-fix.-they-previously-worked-fine." class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="application-national-supported-work-data-dont-read-some-things-have-run-into-errors-which-will-hopefully-be-a-simple-fix.-they-previously-worked-fine."><span class="header-section-number">1.3</span> Application: National Supported Work Data (DONT READ, some things have run into errors which will hopefully be a simple fix. they previously worked fine. )</h2>
<p>While the NSW dataset has often been applied in the context of propensity score methods in textbook examples. Seldom has treatment effect heterogeneity been explored. The Causal Tree earlier suggested that age and education may be significant indicators of the success of the programme for individuals. Using the <code>grf</code> package, the model is fit using all covariates including income in earlier years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'grf'</span>)</span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>covars <span class="ot">&lt;-</span> nsw_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, educ, black, hisp, marr, degree, re74)</span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>nsw_cf_model <span class="ot">&lt;-</span> <span class="fu">causal_forest</span>(</span>
<span id="annotated-cell-4-6"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> covars,</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">as.vector</span>(nsw_data<span class="sc">$</span>re78),</span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">W =</span> <span class="fu">as.vector</span>(nsw_data<span class="sc">$</span>treat),</span>
<span id="annotated-cell-4-9"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tune.parameters =</span> <span class="st">"all"</span>,</span>
<span id="annotated-cell-4-10"><a href="#annotated-cell-4-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">88</span>)</span>
<span id="annotated-cell-4-11"><a href="#annotated-cell-4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-12"><a href="#annotated-cell-4-12" aria-hidden="true" tabindex="-1"></a>  nsw_ite_predict <span class="ot">&lt;-</span><span class="fu">predict</span>(nsw_cf_model, <span class="at">estimate.variance =</span> <span class="cn">TRUE</span>)</span>
<span id="annotated-cell-4-13"><a href="#annotated-cell-4-13" aria-hidden="true" tabindex="-1"></a>  nsw_ite <span class="ot">&lt;-</span> nsw_ite_predict<span class="sc">$</span>predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="annotated-cell-5"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'grf'</span>)</span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'grf'</span>)</span>
<span id="annotated-cell-5-3"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>nsw_cf_model <span class="ot">&lt;-</span> <span class="fu">causal_forest</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-5-5" class="code-annotation-target"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> nsw_covariates,</span>
<span id="annotated-cell-5-6"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> nsw_dependant,</span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">W =</span> nsw_treatment,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-5-8" class="code-annotation-target"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tune.parameters =</span> <span class="st">"all"</span>)</span>
<span id="annotated-cell-5-9"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-5-10" class="code-annotation-target"><a href="#annotated-cell-5-10" aria-hidden="true" tabindex="-1"></a>  nsw_ite_predict <span class="ot">&lt;-</span><span class="fu">predict</span>(nsw_cf_model, <span class="at">estimate.variance =</span> <span class="cn">TRUE</span>)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-5-11" class="code-annotation-target"><a href="#annotated-cell-5-11" aria-hidden="true" tabindex="-1"></a>  nsw_ite <span class="ot">&lt;-</span> nsw_ite_predict<span class="sc">$</span>predictions</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="5,6,7" data-code-annotation="1">The observed covariates, dependant variable, and treatment variable are specified as <code>X</code>, <code>Y</code>, and <code>W</code> respectively. Note that these will be in vector form such as <code>as.vector()</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="8" data-code-annotation="2">The <code>causal_forest()</code> function will tune for <code>sample.fraction</code>, <code>mtry</code>, <code>min.node.size</code>, <code>honesty.fraction</code>, <code>honesty.prune.leaves</code>, <code>alpha</code>, and <code>imbalance.penalty</code>. These can be manually specified but that is beyond the scope of this book. Further information can be obtained inside R using <code>?causal_forest</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="10" data-code-annotation="3">Predictions are made from the <code>nsw_cf_model</code> object and <code>estimated.variance</code> is set <code>TRUE</code> because reason.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="11" data-code-annotation="4">The ITE are extracted from the <code>nsw_ite_predict</code> object. <!-- make sure to explain the data int he intro --> <!-- code annotations dont work with latex pdf --></span>
</dd>
</dl>
<p>Using the the Causal Forest model, <code>nsw_cf_model</code>, a response surface can be displayed as in <a href="#fig-causalTree-3d" class="quarto-xref">Figure&nbsp;3</a>. As before, this is estimated holding all other variables at their mean. This visualisation is somewhat dubious as the various trees inside the forest will have split on other variables as well as education and age so holding them constant somewhat undermines the model structure. However, for the purposes of demonstration, this visualisation is helpful regardless.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the Code to Visualise the Causal Forest.</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grf)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">age =</span> age_seq,<span class="at">educ =</span> educ_seq)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>mean_values <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(nsw_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>other_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(nsw_data)[<span class="sc">!</span>(<span class="fu">names</span>(nsw_data) <span class="sc">%in%</span>  <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"educ"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"response"</span>,<span class="st">"ite"</span>, <span class="st">"re78"</span>,<span class="st">"re75"</span>, <span class="st">"data_id"</span>,<span class="st">"treat"</span>))]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> other_vars) {</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>grid[[var]] <span class="ot">&lt;-</span> mean_values[var]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(nsw_cf_model, <span class="at">newdata =</span> grid)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>response_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(grid<span class="sc">$</span>predictions)),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nrow =</span> <span class="fu">length</span>(educ_seq), <span class="at">ncol =</span> <span class="fu">length</span>(age_seq))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="at">x =</span> <span class="sc">~</span>age_seq,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="at">y =</span> <span class="sc">~</span>educ_seq,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="at">z =</span> <span class="sc">~</span>response_matrix,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="at">type =</span> <span class="st">'surface'</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="at">colorscale =</span> <span class="fu">list</span>(</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">0.25</span>, <span class="st">'rgb(0, 255, 255)'</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="at">showscale =</span> <span class="cn">FALSE</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>camera <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="at">eye =</span> <span class="fu">list</span>(<span class="at">x=</span><span class="sc">-</span><span class="fl">1.7</span>, <span class="at">y=</span><span class="sc">-</span><span class="fl">1.7</span>, <span class="at">z=</span><span class="fl">1.7</span>),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="at">center =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">0</span>),</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="at">up =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">1</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Age'</span>),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Education'</span>),</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"ITE in $'s"</span>),</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="at">camera =</span> camera</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="at">title =</span> <span class="st">'3D Response Surface of Causal Forest: Age vs Education'</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-causalForest-3d" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-causalForest-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-439996ec5e688a47b023" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-439996ec5e688a47b023">{"x":{"visdat":{"9e541ab67a75":["function () ","plotlyVisDat"]},"cur_data":"9e541ab67a75","attrs":{"9e541ab67a75":{"x":{},"y":{},"z":{},"colorscale":[["0.25","rgb(0, 255, 255)"]],"showscale":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Age"},"yaxis":{"title":"Education"},"zaxis":{"title":"ITE in $'s"},"camera":{"eye":{"x":-1.7,"y":-1.7,"z":1.7},"center":{"x":0,"y":0,"z":0},"up":{"x":0,"y":0,"z":1}}},"title":"3D Response Surface of Causal Forest: Age vs Education","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"response_matrix","ticklen":2},"colorscale":[["0.25","rgb(0, 255, 255)"]],"showscale":false,"x":[17,17.775510204081634,18.551020408163264,19.326530612244898,20.102040816326529,20.877551020408163,21.653061224489797,22.428571428571431,23.204081632653061,23.979591836734691,24.755102040816325,25.530612244897959,26.306122448979593,27.081632653061224,27.857142857142858,28.632653061224488,29.408163265306122,30.183673469387756,30.959183673469386,31.73469387755102,32.510204081632651,33.285714285714285,34.061224489795919,34.836734693877546,35.612244897959187,36.387755102040813,37.163265306122447,37.938775510204081,38.714285714285715,39.489795918367349,40.265306122448976,41.04081632653061,41.816326530612244,42.591836734693878,43.367346938775512,44.142857142857139,44.918367346938773,45.693877551020407,46.469387755102041,47.244897959183675,48.020408163265301,48.795918367346943,49.571428571428569,50.346938775510203,51.122448979591837,51.897959183673471,52.673469387755098,53.448979591836732,54.224489795918366,55],"y":[3,3.2653061224489797,3.5306122448979593,3.795918367346939,4.0612244897959187,4.3265306122448983,4.591836734693878,4.8571428571428577,5.1224489795918373,5.387755102040817,5.6530612244897966,5.9183673469387763,6.1836734693877551,6.4489795918367347,6.7142857142857144,6.9795918367346941,7.2448979591836737,7.5102040816326534,7.7755102040816331,8.0408163265306136,8.3061224489795933,8.571428571428573,8.8367346938775526,9.1020408163265323,9.3673469387755102,9.6326530612244898,9.8979591836734695,10.163265306122449,10.428571428571429,10.693877551020408,10.959183673469388,11.224489795918368,11.489795918367347,11.755102040816327,12.020408163265307,12.285714285714286,12.551020408163266,12.816326530612246,13.081632653061225,13.346938775510205,13.612244897959185,13.877551020408164,14.142857142857144,14.408163265306124,14.673469387755103,14.938775510204083,15.204081632653063,15.469387755102042,15.73469387755102,16],"z":[[1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1101.3074252499744,1101.3074252499744,1101.3074252499744,1101.3074252499744,1582.1083814339972,1582.1083814339972,1582.1083814339972,1582.1083814339972,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962],[1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1101.3074252499744,1101.3074252499744,1101.3074252499744,1101.3074252499744,1582.1083814339972,1582.1083814339972,1582.1083814339972,1582.1083814339972,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962],[1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1101.3074252499744,1101.3074252499744,1101.3074252499744,1101.3074252499744,1582.1083814339972,1582.1083814339972,1582.1083814339972,1582.1083814339972,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962],[1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1047.0305365822128,1101.3074252499744,1101.3074252499744,1101.3074252499744,1101.3074252499744,1582.1083814339972,1582.1083814339972,1582.1083814339972,1582.1083814339972,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962,1586.451717939962],[1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1102.5653297477097,1102.5653297477097,1102.5653297477097,1102.5653297477097,1583.2055579229309,1583.2055579229309,1583.2055579229309,1583.2055579229309,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577],[1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1048.3182857495929,1102.5653297477097,1102.5653297477097,1102.5653297477097,1102.5653297477097,1583.2055579229309,1583.2055579229309,1583.2055579229309,1583.2055579229309,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577,1587.5496540696577],[1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1072.3240830599298,1126.532334175683,1126.532334175683,1126.532334175683,1126.532334175683,1606.5339829721181,1606.5339829721181,1606.5339829721181,1606.5339829721181,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307,1610.8726855636307],[1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1100.8662005833544,1154.9603291993776,1154.9603291993776,1154.9603291993776,1154.9603291993776,1634.3270181307839,1634.3270181307839,1634.3270181307839,1634.3270181307839,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124,1638.66938932124],[1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1210.9262299810889,1210.9262299810889,1210.9262299810889,1210.9262299810889,1688.6639753074746,1688.6639753074746,1688.6639753074746,1688.6639753074746,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191],[1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1156.8077154608147,1210.9262299810889,1210.9262299810889,1210.9262299810889,1210.9262299810889,1688.6639753074746,1688.6639753074746,1688.6639753074746,1688.6639753074746,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191,1692.9783568168191],[1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1380.531308317014,1435.1480598969847,1435.1480598969847,1435.1480598969847,1435.1480598969847,1908.6220942363277,1908.6220942363277,1908.6220942363277,1908.6220942363277,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613,1912.8769179226613],[1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1509.0873897442539,1563.5855325736845,1563.5855325736845,1563.5855325736845,1563.5855325736845,2034.2923491286815,2034.2923491286815,2034.2923491286815,2034.2923491286815,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424,2038.515722483424],[1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1571.105139752088,1625.6907900540446,1625.6907900540446,1625.6907900540446,1625.6907900540446,2094.4677778939572,2094.4677778939572,2094.4677778939572,2094.4677778939572,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551,2098.6493326883551],[1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1660.8173997297777,1660.8173997297777,1660.8173997297777,1660.8173997297777,2128.548398633106,2128.548398633106,2128.548398633106,2128.548398633106,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292],[1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1606.0218079431361,1660.8173997297777,1660.8173997297777,1660.8173997297777,1660.8173997297777,2128.548398633106,2128.548398633106,2128.548398633106,2128.548398633106,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292,2132.6867253083292],[1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1610.9755329718657,1665.7475875264854,1665.7475875264854,1665.7475875264854,1665.7475875264854,2133.450348535483,2133.450348535483,2133.450348535483,2133.450348535483,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374,2137.5912157294374],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909],[1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1609.0698046452467,1663.8354219131763,1663.8354219131763,1663.8354219131763,1663.8354219131763,2131.5059727296848,2131.5059727296848,2131.5059727296848,2131.5059727296848,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909,2135.6469827898909]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-causalForest-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: rewrite: The interaction between age and education is shown in the response surface of the causal Forest The visualisation is interactive when viewing as an html web file.
</figcaption>
</figure>
</div>
</div>
<p>While the response surface is still sharp in some places, there is a visible gradient showing the increase</p>
<p>Additionally, using the causal forest, the estimates of the average treatment effect seem more likely. The effect is predicted to be positive for all individuals when holding all other individuals at their mean values. However, the general relationship and heterogeneity in the data is the same. The Causal Forest finds that increasing age and increasing education results in a higher individual treatment effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggthemes)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(scales)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(nsw_data) +</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   aes(x = as.factor(degree), y = ite) +</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_boxplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(nsw_data) +</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   aes(x = as.factor(marr), y = ite) +</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_boxplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(nsw_data) +</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   aes(x = as.factor(black), y = ite) +</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_boxplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(nsw_data) +</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   aes(x = as.factor(hisp), y = ite) +</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_boxplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nsw_data, <span class="fu">aes</span>(<span class="at">x =</span> educ, <span class="at">y =</span> nsw_ite)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Visualising Treatment Effect Heterogeneity"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Years of Education vs. Estimated Individual Treatment Effect"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Individual Treatment Effect ($ Increase in Earnings in 1978)"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Years of Education"</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rangeframe</span>() <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size =</span> <span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nsw_data, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> nsw_ite, <span class="at">color =</span> <span class="fu">as.factor</span>(degree))) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Visualising Treatment Effect Heterogeneity"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Age of Participant vs. Estimated Individual Treatment Effect"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Individual Treatment Effect ($ Increase in Earnings in 1978)"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (Years)"</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rangeframe</span>() <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size =</span> <span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Bachelor Degree Completion:"</span>,<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"red"</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"black"</span> ),</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Degree"</span>,<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"No Degree"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This result makes sense heuristically for a couple of reasons. Perhaps older individuals are more likely to appreciate stable employment opportunities, leading to more engagement with the programme. <span class="citation" data-cites="lalonde">(<a href="#ref-lalonde" role="doc-biblioref"><strong>lalonde?</strong></a>)</span> notes that older and more educated poeple completed the programme at a higher rate demonstrating their commitment. Perhaps the training programme taught skills this demographic was disproportionately lacking. Perhaps more educated individuals experience higher treatment effects due to better job readiness and adaptability to new training. Perhaps different demographics suffered from unemployment for different reasons leading to heterogeneous results.</p>
<p>I should remind readers of an important caveat, these results are found through exploratory research and are not confirmatory. However, they are an indication that there is substantial heterogeneity present which further research can confirm the results of. This further research likely requires a different research design to isolate the heterogeneity caused by age and education. This result could be entirely spurious or due to an unobserved confounders.</p>
<p>Perhaps the older demographics were motivated workers but unemployed/underemployed because of structural changes in the economy such as the general decline in manufacturing jobs in the late 1970’s in the United States. Meanwhile younger applications may have personal reasons for unemployment/underemployment meaning they were less driven or motivated to to obtain higher earning jobs after the programme. While this speculation is unlikely to be the cause of this heterogeneity, it does reinforce the idea that exploratory research should not be confused wth confirmatory research. There are many hypothetical confounding relationships that exist which can be speculated upon but the key idea is that the research design does not control for some of these reasons and so we cannot conclude from the exploratory finding that there is a confirmation increased age or education leading to higher treatment effects in work programmes.</p>
<!-- To get better smotheness a possible helper is the local linear forest. look into this. -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Athey2016" class="csl-entry" role="listitem">
Athey, Susan, and Guido Imbens. 2016. <span>“<span class="nocase">Recursive partitioning for heterogeneous causal effects</span>.”</span> <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113 (27): 7353–60. <a href="https://doi.org/10.1073/pnas.1510489113">https://doi.org/10.1073/pnas.1510489113</a>.
</div>
<div id="ref-Athey2019grf" class="csl-entry" role="listitem">
Athey, Susan, Julie Tibshirani, and Stefan Wager. 2019. <span>“<span class="nocase">Generalized random forests</span>.”</span> <em>Annals of Statistics</em> 47 (2): 1179–1203. <a href="https://doi.org/10.1214/18-AOS1709">https://doi.org/10.1214/18-AOS1709</a>.
</div>
<div id="ref-Breiman1996" class="csl-entry" role="listitem">
Breiman, Leo. 1996. <span>“<span class="nocase">Bagging predictors</span>.”</span> <em>Machine Learning</em> 24: 123–40. <a href="https://doi.org/10.3390/risks8030083">https://doi.org/10.3390/risks8030083</a>.
</div>
<div id="ref-Breiman2001" class="csl-entry" role="listitem">
Brieman, Leo. 2001. <span>“<span>Random Forests</span>.”</span> <em>Machine Learning</em> 45: 5–32. https://doi.org/<a href="https://doi.org/10.1023/A:1010933404324">https://doi.org/10.1023/A:1010933404324</a>.
</div>
<div id="ref-Friedman2001" class="csl-entry" role="listitem">
Friedman, Jerome H. 2001. <span>“<span>Greedy Function Approximation: A Gradient Boosting Machine</span>.”</span> <em>The Annals of Statistics</em> 29 (5): 1189–1232. <a href="https://www.jstor.org/stable/2699986">https://www.jstor.org/stable/2699986</a>.
</div>
<div id="ref-Jawadekar2023" class="csl-entry" role="listitem">
Jawadekar, Neal, Katrina Kezios, Michelle C. Odden, Jeanette A. Stingone, Sebastian Calonico, Kara Rudolph, and Adina Zeki Al Hazzouri. 2023. <span>“<span class="nocase">Practical Guide to Honest Causal Forests for Identifying Heterogeneous Treatment Effects</span>.”</span> <em>American Journal of Epidemiology</em> 192 (7): 1155–65. <a href="https://doi.org/10.1093/aje/kwad043">https://doi.org/10.1093/aje/kwad043</a>.
</div>
<div id="ref-Lewbel2007" class="csl-entry" role="listitem">
Lewbel, Arthur. 2007. <span>“<span class="nocase">A local generalized method of moments estimator</span>.”</span> <em>Economics Letters</em> 94 (1): 124–28. <a href="https://doi.org/10.1016/j.econlet.2006.08.011">https://doi.org/10.1016/j.econlet.2006.08.011</a>.
</div>
<div id="ref-Nie2021" class="csl-entry" role="listitem">
Nie, X., and S. Wager. 2021. <span>“<span class="nocase">Quasi-oracle estimation of heterogeneous treatment effects</span>.”</span> <em>Biometrika</em> 108 (2): 299–319. <a href="https://doi.org/10.1093/biomet/asaa076">https://doi.org/10.1093/biomet/asaa076</a>.
</div>
<div id="ref-Robinson1988" class="csl-entry" role="listitem">
Robinson, P.m. 1988. <span>“<span>Root-N-Consistent Semiparametric Regression</span>.”</span> <em>The Econometric Socieity</em> 56 (4): 931–54. <a href="https://www.jstor.org/stable/1912705">https://www.jstor.org/stable/1912705</a>.
</div>
<div id="ref-Schwab2020" class="csl-entry" role="listitem">
Schwab, Simon, and Leonhard Held. 2020. <span>“<span class="nocase">Different worlds Confirmatory versus exploratory research</span>.”</span> <em>Significance</em> 17 (2): 8–9. <a href="https://doi.org/10.1111/1740-9713.01369">https://doi.org/10.1111/1740-9713.01369</a>.
</div>
<div id="ref-Wager2018hterf" class="csl-entry" role="listitem">
Wager, Stefan, and Susan Athey. 2018. <span>“<span class="nocase">Estimation and Inference of Heterogeneous Treatment Effects using Random Forests</span>.”</span> <em>Journal of the American Statistical Association</em> 113 (523): 1228–42. <a href="https://doi.org/10.1080/01621459.2017.1319839">https://doi.org/10.1080/01621459.2017.1319839</a>.
</div>
<div id="ref-Wager2014" class="csl-entry" role="listitem">
Wager, Stefan, Trevor Hastie, and Bradley Efron. 2014. <span>“<span class="nocase">Confidence intervals for random forests: The jackknife and the infinitesimal jackknife</span>.”</span> <em>Journal of Machine Learning Research</em> 15: 1625–51. <a href="https://arxiv.org/abs/1311.4555">https://arxiv.org/abs/1311.4555</a>.
</div>
<div id="ref-Weisberg1982" class="csl-entry" role="listitem">
Weisberg, Sanford, and R D Cook. 1982. <em><span class="nocase">Residuals and Influence in Regression</span></em>. Chapman <span>&amp;</span> Hall.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>It appears to me that the <code>htetree</code> package has a more comprehensive implimentation compared to the original <code>causalTree</code> package created by Susan Athey which is hosted on <a href="https://github.com/susanathey/causalTree">Github</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The estimation of <span class="math inline">\(\hat{\theta}(x)\)</span> in <span class="math inline">\(P\)</span>, cannot use weights, <span class="math inline">\(\alpha_i(x)\)</span> as these have not been estimated yet.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Note this step aligns with the general form of the influence function. Specifically from <span class="citation" data-cites="Weisberg1982">Weisberg and Cook (<a href="#ref-Weisberg1982" role="doc-biblioref">1982</a>)</span>: <span class="math inline">\(I(z) = -H_{\hat{\theta}}^{-1} \nabla_{\theta} \Psi(z, \hat{\theta})\)</span>. <span class="math inline">\(I(z)\)</span> is the influence function for the point <span class="math inline">\(z\)</span>. <span class="math inline">\(H_{\hat{\theta}}^{-1}\)</span> is the inverse of the Hessian matrix of the log-likelihood (or another objective function). <span class="math inline">\(\nabla_{\theta} \Psi(z, \hat{\theta})\)</span> is the gradient of the function <span class="math inline">\(\Psi\)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>